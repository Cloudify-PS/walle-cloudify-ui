<div data-ng-repeat="node in map track by node.name" ng-class="{box: !node.isApp, app: node.isApp, boxHover:hover}" data-type="{{node.dataType}}" blueprint:coordinate="{{node.id}}">



    <div progress:pie="piProgress2" class="piProgress" size="55">
        <div class="badge-title" ng-class="getBadgeStatus(node)" ng-show="shouldShowBadgeTitle(node)" >{{getCompleted(node)}}/{{getTotal(node)}}</div>
        <div class="circle" ng-click="onNodeSelect({ 'node' : node })">
            <i class="gs-node-icon topology-glyph" ng-class="node.class"></i>
            <div class="badge without-icon" ng-show="!nodeInstances">{{ node.instances.deploy }}</div>
            <div class="badge with-icon" data-ng-class="getBadgeStatusAndIcon(node)" ng-show="shouldShowBadge(node)">
                <!-- Don't remove this newline, it will make the badge disappear! -->
            </div>
        </div>
    </div>


    <div class="connections" ng-show="node.isHost == true">
        <div class="connection" ng-class="relationship.target_id" data-ng-show="isConnectedTo(relationship)" data-ng-repeat="relationship in node.relationships">
            <i class="gs-node-icon topology-glyph small cloudify-nodes-Root" ng-class="relationship.node.class" ng-click="onRelationshipSelected(relationship)"></i>
        </div>
    </div>

    <div class="head" ng-click="onNodeSelect({ 'node' : node})" tooltip ng-mouseover="hover=true" ng-mouseleave="hover=false" >
        {{ node.name }}
    </div>
    <div class="holder" ng-show="node.isApp == false" data-ng-if="node.isApp == false">


        <div bp-topology-nodes
             initialized="initialized"
             in-progress="inProgress"
             node-instances="nodeInstances"
             map="node.children"
             selected="onNodeSelect({'node' : node})">

        </div>
    </div>

    <p ng-show="node.isApp == true" ng-click="onNodeSelect({ 'node' : node})" tooltip>{{ node.name }}</p>
</div>
