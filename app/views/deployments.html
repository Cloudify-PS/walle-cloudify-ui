<div class="cosmo-layout" id="deployments">

    <div class="content-header">
        <div class="breadcrumbs"><ul id="deployments" breadcrumbs></ul></div>
    </div>

    <table ng-show="!cosmoConnectionError()">
        <tr ng-repeat="blueprint in blueprints">
            <td>

                <table>
                    <tr class="blueprint-name" ng-click="showDeployments(blueprint.id)">
                        <td><div class="blueprint-arrow" ng-class="{'down': selectedBlueprint == blueprint.id, 'right': selectedBlueprint != blueprint.id}"></div>{{blueprint.id}}</td>
                        <td><div class="deployments-number">{{blueprint.deployments.length}}</div></td>
                    </tr>
                    <tr ng-show="selectedBlueprint == blueprint.id">
                        <td>
                            <div ng-show="blueprint.deployments.length == 0">{{ 'deployments.emptyMessage' | i18n }}</div>
                            <table class="table table-striped" ng-show="blueprint.deployments.length > 0">
                                <tr>
                                    <td class="id">{{ 'deployments.table.heading.id' | i18n }}</td>
                                    <td class="create">{{ 'deployments.table.heading.createDate' | i18n }}</td>
                                    <td class="update">{{ 'deployments.table.heading.updated' | i18n }}</td>
                                    <td class="actions">{{ 'deployments.table.heading.action' | i18n }}</td>
                                </tr>
                                <tr ng-repeat="deployment in blueprint.deployments">
                                    <td class="id" ng-click="redirectTo(deployment)">{{deployment.id}}</td>
                                    <td class="create" ng-click="redirectTo(deployment)">{{deployment.createdAt}}</td>
                                    <td class="description" ng-click="redirectTo(deployment)">{{deployment.updatedAt}}</td>
                                    <td class="actions">
                                        <select ng-model="selectedWorkflow"
                                                ng-options="option.name as option.name for option in getWorkflows(deployment)"
                                                ng-change="workflowSelected(selectedWorkflow)"
                                                ng-disabled="isExecuting(deployment.id)"
                                                ng-class="{disable: isExecuting(deployment.id)}"
                                                ng-show="!isExecuting(deployment.id)">
                                            <option value="">-- Select workflow --</option>
                                        </select>
                                        <div class="executingWorkflow" ng-show="isExecuting(deployment.id)">{{executingWorkflow}}</div>
                                        <i class="fa fa-play-circle-o" ng-click="toggleConfirmationDialog(deployment)" ng-show="!isExecuting(deployment.id)"></i>
                                        <i ng-class="{deploymentExecute: isExecuting(deployment.id)}" ng-show="isExecuting(deployment.id)"></i>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>

            </td>
        </tr>
    </table>

    <div class="no-blueprints-message" ng-show="blueprints.length == 0">{{ 'blueprints.emptyMessage' | i18n }}</div>

    <div class="loading" ng-show="blueprints == null && !cosmoConnectionError()"></div>

    <div class="connect-error-message" ng-show="cosmoConnectionError()">{{ 'connectError' | i18n }}</div>

    <div ng-show="isConfirmationDialogVisible">
        <div id="dialogBoxBg"></div>
        <div id="confirmationDialogContainer" class="dialogBox">
            <div class="dialogTitle">{{ 'deployments.confirmationPopup.title' | i18n }}</div>
            <div class="dialogDescription">{{ 'deployments.confirmationPopup.description' | i18n }} {{selectedDeployment.id}}?</div>
            <div class="buttonsContainer confirmationButtons">
                <button id="cancelBtn" class="dialogButton" ng-click="toggleConfirmationDialog()">{{ 'deployments.confirmationPopup.cancelBtn' | i18n }}</button>
                <button id="confirmBtn" class="dialogButton" ng-click="executeDeployment()">{{ 'deployments.confirmationPopup.confirmBtn' | i18n }}</button>
            </div>
        </div>
    </div>
</div>
