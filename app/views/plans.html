<div class="cosmo-layout" id="plans">
    <!-- Side Panel - START -->
    <div class="properties-panel right-panel" ng-hide="!showProperties">
        <div class="title">
            {{showProperties.general.name}} {{'plans.details.details' | i18n }}
            <i ng-click="hideProperties()" class="fa fa-times-circle right"></i>
        </div>
        <div class="content">
            <div class="buttons-group no-embed" checkbox-toggle value="propSection">
                <button ng-repeat="(key, value) in showProperties" type="button" class="btn btn-default" value="{{key}}">{{ 'plans.' + key | i18n }}</button>
            </div>
            <div ng-switch="propSection" class="content-section">
                <div ng-switch-default="general">
                    <table>
                        <tr>
                            <td>{{ 'plans.details.key' | i18n }}</td>
                            <td>{{ 'plans.details.value' | i18n }}</td>
                        </tr>
                        <tr ng-repeat="(key, value) in showProperties.general">
                            <td>{{key}}</td><td>{{value}}</td>
                        </tr>
                    </table>
                </div>
                <div ng-switch-when="properties">
                    <table>
                        <tr>
                            <td>{{ 'plans.details.key' | i18n }}</td>
                            <td>{{ 'plans.details.value' | i18n }}</td>
                        </tr>
                        <tr ng-repeat="(key, value) in showProperties.properties">
                            <td>{{key}}</td><td>{{value}}</td>
                        </tr>
                    </table>
                </div>
                <div ng-switch-when="relationships">
                    <div ng-show="showProperties.relationships.length == undefined">{{ 'plans.details.noRelationships' | i18n }}</div>
                    <table ng-show="showProperties.relationships.length != undefined">
                        <tr>
                            <td>{{ 'plans.details.target' | i18n }}</td>
                            <td>{{ 'plans.details.type' | i18n }}</td>
                            <td>{{ 'plans.details.interface' | i18n }}</td>
                        </tr>
                        <tr ng-repeat="relationship in showProperties.relationships">
                            <td>{{relationship.target_id}}</td>
                            <td>{{relationship.type}}</td>
                            <td>
                                <!--<ul ng-repeat="(key, value) in relationship.source_interfaces">-->
                                    <!--<li>{{value}}</li>-->
                                <!--</ul>-->
                            </td>
                        </tr>
                    </table>
                </div>
                <pre ng-switch-when="interfaces">{{showProperties.interfaces | yaml:'No interfaces to display' }} </pre>
            </div>
        </div>
    </div>
    <!-- Side Panel - END -->
    <!-- Breadcrumbs - START -->
    <div class="content-header no-embed">
        <div class="breadcrumbs"><ul id="blueprints" breadcrumbs></ul></div>
     </div>
    <!-- Breadcrumbs - END -->
    <!-- Settings - START -->
    <div class="buttons-group no-embed" checkbox-toggle value="section">
        <button type="button" class="btn btn-default" value="topology">Topology</button>
        <button type="button" class="btn btn-default" value="network" data-ng-show="networks.networks.length">Network</button>
        <button type="button" class="btn btn-default" value="nodes">Nodes</button>
        <button type="button" class="btn btn-default" value="code">Source</button>
    </div>
    <div settings-toggles id="settings-button" class="no-embed" toggles="toggleBar"></div>
    <!-- Settings - END -->
    <button class="deploy-button" ng-click="toggleDeployDialog(blueprint)">{{ 'blueprints.table.deployBtn' | i18n }}</button>

    <div ng-switch="section" class="content-section">
        <!-- Blueprint Contianter - START -->
        <div class="bpContainer" ng-switch-default="topology" blueprint:resize data-ng-class="{
        disableCompute: !toggleBar.compute,
        disableMiddleware: !toggleBar.middleware,
        disableModules: !toggleBar.modules,
        disableConnections: !toggleBar.connections
        }">
            <div data-type="compute" data-ng-repeat="rootNode in map" class="box" blueprint:coordinate="{{ rootNode.id }}">
                <div class="hoverup">
                    <div class="buttons no-embed">
                        <ul>
                            <li data-ng-click="viewNode(rootNode)" class="topology-glyph node-details"></li><!--<li class="topology-glyph edit-node"></li>-->
                        </ul>
                    </div>
                </div>
                <div pie:progress="piProgress2" class="piProgress" size="47">
                    <div class="circle">
                        <i class="icon topology-glyph host"></i>
                        <div class="badge">{{ indexNodes[rootNode.id].general.numOfInstances }}</div>
                    </div>
                </div>
                <div class="head">{{ indexNodes[rootNode.id].name }}</div>
                <div class="holder">
                    <!-- Middleware::start -->
                    <div data-type="middleware" data-ng-repeat="subNode in rootNode.children" class="box" blueprint:coordinate="{{ subNode.id }}">
                        <div class="hoverup">
                            <div class="buttons no-embed">
                                <ul>
                                    <li data-ng-click="viewNode(subNode)" class="topology-glyph node-details"></li><!--<li class="topology-glyph edit-node"></li>-->
                                </ul>
                            </div>
                        </div>
                        <div pie:progress="piProgress2" class="piProgress" size="47">
                            <div class="circle">
                                <i class="icon topology-glyph app-server"></i>
                                <div class="badge">{{ indexNodes[subNode.id].general.numOfInstances }}</div>
                            </div>
                        </div>
                        <div class="head">{{ indexNodes[subNode.id].name }}</div>
                        <div class="holder">
                            <!-- Module::start -->
                            <div data-type="modules" data-ng-repeat="appNode in subNode.children" class="app">
                                <div class="hoverup">
                                    <div class="buttons no-embed">
                                        <ul>
                                            <li data-ng-click="viewNode(appNode)" class="topology-glyph node-details"></li><!--<li class="topology-glyph edit-node"></li>-->
                                        </ul>
                                    </div>
                                </div>
                                <div pie:progress="piProgress2" class="piProgress" size="47">
                                    <div class="circle" blueprint:coordinate="{{ appNode.id }}">
                                        <i class="icon topology-glyph app-module"></i>
                                        <div class="badge">{{ indexNodes[appNode.id].general.numOfInstances }}</div>
                                    </div>
                                </div>
                                <p>{{ indexNodes[appNode.id].name }}</p>
                            </div>
                            <!-- Module::end -->
                        </div>
                    </div>
                    <!-- Middleware::end -->
                </div>
            </div>
            <div class="coordinates" blueprint:arrows="coordinates" arrow="true"></div>
        </div>
        <!-- Blueprint Contianter - END -->
        <!-- Network Topology - START -->
        <div class="networksContainer" ng-switch-when="network">
            <div bp:networks class="relations" ng-model="networkcoords"></div>
            <div data-ng-repeat="network in networks.external" class="network">
                <div class="line">
                    <div class="name-space"></div>
                    <div data-ng-repeat="subnet in network.subnets" class="subnet" bp:network:coordinate ng-model="subnet">
                        <p>{{ subnet.name }}</p>
                        <p class="cidr">External Network</p>
                    </div>
                </div>
                <div class="devices">
                    <div data-ng-repeat="device in network.devices" class="device" bp:network:coordinate ng-model="device">
                        <i class="topology-glyph {{ device.icon }}"></i>
                    </div>
                </div>
            </div>
            <div data-ng-repeat="network in networks.networks" class="network">
                <div class="line">
                    <div class="name">{{ network.name }}</div>
                    <div data-ng-repeat="subnet in network.subnets" class="subnet" bp:network:coordinate ng-model="subnet">
                        <p>{{ subnet.name }}</p>
                        <p class="cidr">{{ subnet.cidr }}</p>
                    </div>
                </div>
                <div class="devices">
                    <div data-ng-repeat="device in network.devices" class="device" bp:network:coordinate ng-model="device">
                        <div class="buttons no-embed">
                            <ul>
                                <li data-ng-click="viewNode(device)" class="topology-glyph node-details"></li><li class="topology-glyph edit-node"></li>
                            </ul>
                        </div>
                        <i class="topology-glyph {{ device.icon }}"></i>
                    </div>
                </div>
            </div>
        </div>
        <!-- Network Topology - END -->
        <!-- Nodes - START -->
        <div ng-switch-when="nodes">
            <table class="table">
                <thead>
                    <tr>
                        <th></th>
                        <th>Name</th>
                        <th>Type</th>
                        <th>Number of instances</th>
                        <th>Contained in</th>
                        <th>Connected to</th>
                        <th><!--Actions--></th>
                    </tr>
                </thead>
                <tbody data-ng-repeat="row in dataTable">
                    <tr>
                        <td><i class="topology-glyph {{ getIcon(row.iconType) }}"></i></td>
                        <td>{{ row.name }}</td>
                        <td>{{ row.type }}</td>
                        <td>{{ row.instances }}</td>
                        <td>
                            <span data-ng-if="row.contained_in != false">{{ indexNodes[row.contained_in].name }}</span>
                            <span data-ng-if="row.contained_in == false">--</span>
                        </td>
                        <td>
                            <span data-ng-if="row.connected_to.length > 0" data-ng-repeat="connection in row.connected_to">{{ indexNodes[connection].name }}</span>
                            <span data-ng-if="row.connected_to == 0">--</span>
                        </td>
                        <td>
                            <ul>
                                <li data-ng-click="viewNode(indexNodes[row.id])" class="topology-glyph node-details"></li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- Nodes - END -->
        <!-- Code - START -->
        <div ng-switch-when="code">
            <pre>
                <div code:highlight="yml" ng-model="dataCode"></div>
            </pre>
        </div>
        <!-- Code - END -->
    </div>

    <div ng-show="isDeployDialogVisible" ng-controller="DeployDialogCtrl">
        <div class="dialogBoxBg"></div>
        <div id="confirmationDialogContainer" class="dialogBox">
            <div class="dialogTitle">{{ 'blueprints.deployDialog.title' | i18n }} {{selectedBlueprint.id}}</div>
            <div class="dialogDeploymentName">
                <label>{{ 'blueprints.deployDialog.deployName' | i18n }}</label>
                <input type="text" ng-model="deploymentId">
            </div>
            <div id="deploy-error-message" ng-show="isDeployError()">{{deployErrorMessage}}</div>
            <div class="buttonsContainer deployButtons">
                <button id="cancelBtn" class="dialogButton" ng-click="toggleDeployDialog()">{{ 'blueprints.deployDialog.cancelBtn' | i18n }}</button>
                <button id="deployBtn" class="dialogButton" ng-class="{disabled: !isDeployEnabled(), enabled: isDeployEnabled()}" ng-click="deployBlueprint(blueprint)">{{ 'blueprints.deployDialog.deployBtn' | i18n }}</button>
            </div>
        </div>
    </div>
</div>

